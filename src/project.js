window.__require=function t(e,n,o){function i(a,c){if(!n[a]){if(!e[a]){var l=a.split("/");if(l=l[l.length-1],!e[l]){var h="function"==typeof __require&&__require;if(!c&&h)return h(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+a+"'")}a=l}var r=n[a]={exports:{}};e[a][0].call(r.exports,function(t){return i(e[a][1][t]||t)},r,r.exports,t,e,n,o)}return n[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({Game:[function(t,e,n){"use strict";cc._RF.push(e,"ac3d3L3Ce1MOoeM6lAr2/wS","Game"),cc.Class({extends:cc.Component,properties:{player:{default:null,type:cc.Node},ball:{default:null,type:cc.Prefab},bonus:{default:null,type:cc.Prefab},ballsnode:{default:null,type:cc.Node},brick:{default:null,type:cc.Prefab},bricknode:{default:null,type:cc.Node},loadnode:{default:null,type:cc.Node},levelnode:{default:null,type:cc.Node},scorenode:{default:null,type:cc.Node},minBrickPerLine:{default:2},maxBrickPerLine:{default:5},bonusEveryX:{default:10}},onLoad:function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.gravity=cc.v2(0,0),this.ballsPool=new cc.NodePool,this.ballsPool.put(cc.instantiate(this.ball)),this.brickPool=new cc.NodePool,this.brickPool.put(cc.instantiate(this.brick)),this.bonusPool=new cc.NodePool,this.bonusPool.put(cc.instantiate(this.bonus)),this.restart()},restart:function(){this.score=0,this.level=1,this.load=3,this.shooting=!0,this.loadnode.getComponent(cc.Label).string=this.load,this.levelnode.getComponent(cc.Label).string="L"+this.level,this.scorenode.getComponent(cc.Label).string="$"+this.score},start:function(){console.log("GAME START"),this.generateBricks()},generateBricks:function(){var t=this.getRandom(this.minBrickPerLine,this.maxBrickPerLine);console.log("generating "+t+" bricks");var e=[5,2,3,4,8,1,6,7];this.shuffle(e);for(var n=0;n<t;n++)this.spawnNewBrick(e[n],this.level);this.level%this.bonusEveryX==0&&this.spawnNewBonus(e[t]),this.bricksDown()},bricksDown:function(){console.log("move bricks down");var t=this.bricknode.children.length,e=0;this.schedule(function n(){e>=t?(this.unschedule(n),this.shooting=!1):("brick"==this.bricknode.children[e].group?this.bricknode.children[e].getComponent("brick").moveDown():"bonus"==this.bricknode.children[e].group&&this.bricknode.children[e].getComponent("bonus").moveDown(),e++)},.01)},getRandom:function(t,e){switch(arguments.length){case 1:return parseInt(Math.random()*t+1,10);case 2:return parseInt(Math.random()*(e-t+1)+t,10);default:return 0}},shuffle:function(t){for(var e=t.length;e;){var n=Math.floor(Math.random()*e--),o=[t[e],t[n]];t[n]=o[0],t[e]=o[1]}},spawnNewBall:function(t){var e=null;return(e=this.ballsPool.size()>0?this.ballsPool.get():cc.instantiate(this.ball)).parent=this.ballsnode,e.getComponent("ball").init(t,this.node),e},spawnNewBonus:function(t){var e=null;return(e=this.bonusPool.size()>0?this.bonusPool.get():cc.instantiate(this.bonus)).parent=this.bricknode,e.getComponent("bonus").init(t,this.node),e},spawnNewBrick:function(t,e){var n=null;return(n=this.brickPool.size()>0?this.brickPool.get():cc.instantiate(this.brick)).parent=this.bricknode,n.getComponent("brick").init(t,e,this.node),n}}),cc._RF.pop()},{}],ball:[function(t,e,n){"use strict";cc._RF.push(e,"84070afcc1IjpwHprfO6nF2","ball"),cc.Class({extends:cc.Component,properties:{angle:{default:Math.PI/2},speedDefault:{default:1700},game:{default:null,type:cc.Node},audioPop:{default:null,type:cc.AudioClip}},init:function(t,e){this.angle=t,this.speed=this.speedDefault,this.node.setPosition(cc.v2(0,-847)),this.game=e,cc.audioEngine.playEffect(this.audioPop,!1),this.vibrate()},onLoad:function(){},start:function(){this.initVibrate()},update:function(t){var e=this.node.getComponent(cc.RigidBody).linearVelocity;e.x=Math.cos(this.angle)*this.speed,e.y=Math.sin(this.angle)*this.speed,this.node.getComponent(cc.RigidBody).linearVelocity=e},onBeginContact:function(t,e,n){if("wall"==n.node.group){var o=t.getWorldManifold().normal;1==o.x?this.angle=Math.PI-this.angle:-1==o.x?this.angle=Math.PI-this.angle:1==o.y?this.angle=2*Math.PI-this.angle:-1==o.y&&this.store(),this.vibrate()}else if("brick"==n.node.group){var i=t.getWorldManifold().normal;1==i.x?this.angle=Math.PI-this.angle:-1==i.x?this.angle=Math.PI-this.angle:1==i.y?this.angle=2*Math.PI-this.angle:-1==i.y?this.angle=2*Math.PI-this.angle:this.angle=Math.PI+Math.acos(i.x/Math.sqrt(i.x*i.x+i.y*i.y)),n.node.getComponent("brick").popNum(),cc.audioEngine.playEffect(this.audioPop,!1),this.vibrate()}else"bonus"==n.node.group&&(n.node.getComponent("bonus").pop(),cc.audioEngine.playEffect(this.audioPop,!1),this.vibrate())},onDestroy:function(){},store:function(){this.game.getComponent("Game").ballsPool.put(this.node)},initVibrate:function(){navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate},vibrate:function(){navigator.vibrate&&navigator.vibrate(15)}}),cc._RF.pop()},{}],bonus:[function(t,e,n){"use strict";cc._RF.push(e,"22be0L+CX1N1Iq1dLxxk+Cl","bonus"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},init:function(t,e){this.linespace=15,this.node.setScale(1,1),this.node.setPosition(this.node.parent.convertToNodeSpaceAR(cc.v2(cc.visibleRect.width/8*(t-1),cc.visibleRect.height+this.node.height))),this.game=e},moveDown:function(){var t=this.node.position;t.y-=this.node.height+this.linespace,cc.tween(this.node).to(1,{position:t},{easing:"elasticOut"}).start()},pop:function(){this.game.getComponent("Game").load++,cc.find("Canvas/displayer/load").getComponent(cc.Label).string="BONUS!",cc.tween(cc.find("Canvas/displayer/load")).to(.2,{scale:2}).to(.2,{scale:1}).start(),this.game.getComponent("Game").bonusPool.put(this.node)},start:function(){}}),cc._RF.pop()},{}],brick:[function(t,e,n){"use strict";cc._RF.push(e,"f605fJLT3pNJr/ewDMqAFfb","brick"),cc.Class({extends:cc.Component,properties:{num:{default:5},numnode:{default:null,type:cc.Node},scorenode:{default:null,type:cc.Node},audioBreak:{default:null,type:cc.AudioClip}},onLoad:function(){},init:function(t,e,n){this.num=e,this.numnode=this.node.getChildByName("num"),this.numnode.getComponent(cc.Label).string=this.num,this.scorenode=cc.find("Canvas/displayer/score"),this.linespace=15,this.node.setPosition(this.node.parent.convertToNodeSpaceAR(cc.v2(cc.visibleRect.width/8*(t-1),cc.visibleRect.height+this.node.height))),this.game=n,this.changeColor()},start:function(){},popNum:function(){this.numnode.getComponent(cc.Label).string=--this.num,this.scorenode.getComponent(cc.Label).string="$"+ ++this.game.getComponent("Game").score,this.num<=0?this.popBrick():this.num%10==0&&this.changeColor()},popBrick:function(){this.game.getComponent("Game").brickPool.put(this.node),cc.audioEngine.playEffect(this.audioBreak,!1),this.vibrate()},changeColor:function(){this.game.getComponent("Game").level<100?this.changeSpriteframe(Math.ceil(this.num/10)):this.changeSpriteframe(Math.ceil(this.num/this.game.getComponent("Game").level*10))},changeSpriteframe:function(t){var e=this;cc.loader.loadRes("brick-"+t,cc.SpriteFrame,function(t,n){e.node.getComponent(cc.Sprite).spriteFrame=n})},moveDown:function(){var t=this.node.position;t.y-=this.node.height+this.linespace,cc.tween(this.node).to(1,{position:t},{easing:"elasticOut"}).start()},initVibrate:function(){navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate},vibrate:function(){navigator.vibrate&&navigator.vibrate(15)}}),cc._RF.pop()},{}],deadline:[function(t,e,n){"use strict";cc._RF.push(e,"77a8d6F4UhHc6JITQDcKYSK","deadline"),cc.Class({extends:cc.Component,properties:{result:{default:null,type:cc.Node},audioOver:{default:null,type:cc.AudioClip}},onLoad:function(){this.restartBtn=this.result.getChildByName("restart");var t=this;this.restartBtn.on(cc.Node.EventType.TOUCH_END,function(e){t.restart()})},start:function(){},onBeginContact:function(t,e,n){"brick"==n.node.group&&this.gameover()},gameover:function(){cc.find("Canvas/bricknode").active=!1,cc.find("Canvas/ballsnode").active=!1,cc.audioEngine.playEffect(this.audioOver,!1),this.showResult()},showResult:function(){this.result.getChildByName("score").getComponent(cc.Label).string=cc.find("Canvas").getComponent("Game").score,this.result.getChildByName("restart").getComponent(cc.Button);var t=cc.v2(0,0);cc.tween(this.result).to(2,{position:t},{easing:"elasticOut"}).start()},restart:function(){cc.director.loadScene("game")}}),cc._RF.pop()},{}],player:[function(t,e,n){"use strict";cc._RF.push(e,"333a0bB9+NL1ZR7AdZNez8V","player"),cc.Class({extends:cc.Component,properties:{angle:{default:Math.PI/2},ballBorder:{default:null,type:cc.Node},game:{default:null,type:cc.Node},bricknode:{default:null,type:cc.Node},ballnode:{default:null,type:cc.Node},loadnode:{default:null,type:cc.Node},levelnode:{default:null,type:cc.Node}},onTouchStart:function(t){if(this.isEnableBoost){this.disableBoost();for(var e=0;e<this.ballnode.children.length;e++){var n=this.ballnode.children[e].getComponent("ball");Math.abs(n.angle)<1/24*Math.PI||Math.abs(n.angle)>23/24*Math.PI?(n.store(),e--):(console.log("speed up"),n.speed=3*n.speedDefault)}}this.gamecomp.shooting||(this.ballBorder.opacity=255),this.tipsnode.active=!1},onTouchMove:function(t){this.gamecomp.shooting||(this.angle=Math.acos((t.getLocation().x-t.getStartLocation().x)/Math.sqrt(Math.pow(t.getLocation().x-t.getStartLocation().x,2)+Math.pow(t.getStartLocation().y-t.getLocation().y,2))),this.angle<1/24*Math.PI&&(this.angle=1/24*Math.PI),this.angle>23/24*Math.PI&&(this.angle=23/24*Math.PI),this.node.angle=180*this.angle/Math.PI-90,this.ballBorder.setPosition(this.node.parent.convertToNodeSpaceAR(t.getLocation())))},onTouchCanceled:function(t){this.gamecomp.shooting||(cc.tween(this.ballBorder).to(.5,{opacity:0,position:cc.v2(0,-847)},{easing:"sineOut"}).start(),cc.tween(this.node).to(1,{angle:0},{easing:"elasticOut"}).start(),this.shoot(this.gamecomp.load))},onTouchEnd:function(t){this.gamecomp.shooting||(cc.tween(this.ballBorder).to(.5,{opacity:0,position:cc.v2(0,-847)},{easing:"sineOut"}).start(),cc.tween(this.node).to(1,{angle:0},{easing:"elasticOut"}).start())},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCanceled,this),this.tipsnode=this.node.getChildByName("tips"),this.boostnode=this.node.getChildByName("boost"),this.boostnode.active=!1,this.gamecomp=this.game.getComponent("Game")},start:function(){this.gamecomp.shooting=!0,this.isEnableBoost=!1;var t=cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1});cc.tween(this.tipsnode).then(t).repeat(30).start()},shoot:function(t){var e=t;this.gamecomp.shooting=!0,console.log("shoot:"+t);this.schedule(function e(){t<=1&&this.unschedule(e),this.gamecomp.spawnNewBall(this.angle),this.loadnode.getComponent(cc.Label).string=--t},.045);var n=0;this.schedule(function t(){console.log("checking left balls"),n>=6&&!this.isEnableBoost&&this.gamecomp.shooting&&this.enableBoost(),0==this.ballnode.children.length?(console.log("all balls' out"),this.unschedule(t),this.isEnableBoost&&this.disableBoost(),this.levelnode.getComponent(cc.Label).string="L"+ ++this.gamecomp.level,this.loadnode.getComponent(cc.Label).string=++this.gamecomp.load,this.gamecomp.generateBricks()):n++},.5,9999,.045*e)},enableBoost:function(){this.isEnableBoost=!0,this.boostnode.active=!0},disableBoost:function(){this.isEnableBoost=!1,this.boostnode.active=!1}}),cc._RF.pop()},{}]},{},["Game","ball","bonus","brick","deadline","player"]);